{% extends 'base.html.twig' %}

{% block title %}Heroes of {{ world.Name }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .hero-card {
            height: 320px;
            position: relative;
            overflow: hidden;
        }

        .hero-card img {
            height: 150px;
            object-fit: cover;
        }

        .action-buttons {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .hero-card.show-actions .action-buttons {
            display: flex;
            opacity: 1;
        }

        .toggle-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            z-index: 3;
            background-color: rgba(0, 0, 0, 0.6);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            color: white;
        }

        .card-body, .action-buttons {
            z-index: 2;
            position: relative;
        }

        .overlay-link {
            position: absolute;
            inset: 0;
            z-index: 1;
        }
    </style>
{% endblock %}

{% block body %}
<div class="container text-white py-4">
    <h1 class="mb-4">Heroes of {{ world.Name }}</h1>

    <a href="{{ path('app_hero_create', { worldId: world.id }) }}" class="btn btn-success mb-4">
        + Create a New Hero
    </a>

    <div class="row row-cols-2 row-cols-md-3 row-cols-lg-5 g-3">
        {% for hero in heroes %}
            <div class="col">
                <div class="card bg-dark text-white border-0 shadow rounded-4 hero-card position-relative" id="card-{{ hero.id }}">
                    {% if hero.ImageHero %}
                        <img src="{{ asset('uploads/heroes/' ~ hero.ImageHero) }}" class="card-img-top rounded-top-4" alt="{{ hero.Name }}">
                    {% endif %}

                    <div class="card-body p-2">
                        <h6 class="card-title mb-1 fw-bold">{{ hero.Name }}</h6>
                        <p class="card-text text-muted small mb-0">{{ hero.Fonction }}</p>
                    </div>

                    <div class="action-buttons justify-content-around gap-1 px-3 pb-2">
                        <a href="{{ path('app_hero_edit', { id: hero.id }) }}" class="btn btn-sm btn-outline-warning">Edit</a>
                        <a href="{{ path('app_hero_delete', { id: hero.id }) }}"
                           class="btn btn-sm btn-outline-danger"
                           onclick="return confirm('Are you sure you want to delete this hero?');">Delete</a>
                    </div>

                    <button class="toggle-btn" onclick="toggleActions(event, {{ hero.id }});">
                        +
                    </button>

                    <a href="{{ path('app_hero_show', { id: hero.id }) }}" class="overlay-link"></a>
                </div>
            </div>
        {% else %}
            <div class="col-12">
                <p class="text-muted">No heroes found in this world.</p>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        function toggleActions(event, id) {
            event.stopPropagation();
            event.preventDefault();
            const card = document.getElementById(`card-${id}`);
            card.classList.toggle('show-actions');
        }
    </script>
{% endblock %}
